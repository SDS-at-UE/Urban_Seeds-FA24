---
title: "MT_sep18"
output: html_document
date: "2024-09-18"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r}
library(shiny)
library(ggplot2)
library(readxl)
library(dplyr) 

pdts_separated <- read.csv("G:/My Drive/a.UE24-25/STAT300/separated_orders_byproduct.csv")
 aggregated_data <- pdts_separated %>%
    group_by(ProductID) %>%
    summarise(Count = n(), OrderDate = (Order.Date), .groups = 'drop')
 
 aggregated_data
 
```

```{r}
date <- as.Date(aggregated_data$OrderDate, format = "%d/%m/%Y") 
Month <- as.numeric(format(date, "%m"))
data.month <- cbind(aggregated_data, Month)
data.month
```

```{r}

ggplot(data.month, aes(x = ProductID, y = Count, color = Month)) +
      geom_histogram(stat = "identity", position = "dodge") +
      xlim(241, 379) + ylim(0, 971) +
      labs(title = "Products Throughout The Months",
           x = "Product ID",
           y = "Number Bought") +
      theme_minimal()
```








```{r}
# Load necessary libraries
library(shiny)
library(ggplot2)
library(readxl)
library(dplyr)  # For data manipulation

# Define UI
ui <- fluidPage(
  titlePanel("Products Throughout The Months"),
  sidebarLayout(
    sidebarPanel(
      uiOutput("productSelect") # Placeholder for dynamic UI input
    ),
    mainPanel(
      plotOutput("productPlot")
    )
  )
)

# Define server logic
server <- function(input, output, session) {
  # Read data from Excel file
  pdts_separated <- read.csv("G:/My Drive/a.UE24-25/STAT300/separated_orders_byproduct.csv")
  
  # Aggregate data: Count occurrences of each ProductID
  aggregated_data <- pdts_separated %>%
    group_by(ProductID) %>%
    summarise(Count = n(), OrderDate = (Order.Date), .groups = 'drop')
  
  date <- as.Date(aggregated_data$OrderDate, format = "%d/%m/%Y") 
  Month <- as.numeric(format(date, "%m"))
  data.month <- cbind(aggregated_data, Month)
  
  # Extract unique product IDs from the aggregated data
  product_types <- unique(aggregated_data$ProductID)
  
  # Create the UI for product selection dynamically
  output$productSelect <- renderUI({
    checkboxGroupInput("selectedProducts", 
                       "Select Products:", 
                       choices = product_types, 
                       selected = product_types)
  })
  
  # Reactive expression to filter and aggregate data based on selected products

  
  # Render plot
  output$productPlot <- renderPlot({
    ggplot(data.month, aes(x = month, y = Count)) +
      geom_bar(stat = "identity", position = "dodge") +
      labs(title = "Products Throughout The Months",
           x = "Month",
           y = "Number of Product") +
      theme_minimal()
  })
}

# Run the application
shinyApp(ui = ui, server = server)
```

  # Reactive expression to filter and aggregate data based on selected products
  filteredData <- reactive({
    req(input$selectedProducts) # Ensure that input$selectedProducts is available
    filtered_data <- data.month %>% 
      filter(ProductID %in% input$selectedProducts) %>%
      group_by(ProductID) %>%
      summarise(Number = sum(data.month$Count), .groups = 'drop')
    filtered_data
  })

